@let student = service.student$ | async;

<div class="flex flex-col items-start sm:flex-row sm:items-baseline sm:space-x-4">
    <h1 class="font-bold">{{ student | studentName: StudentNameStyle.FIRST_MIDDLE_INITIAL_LAST }}</h1>
    <h3 class="text-gray-400">{{ student.id }}</h3>
</div>

<mat-tab-group
    mat-stretch-tabs="false"
    mat-align-tabs="start"
    [selectedIndex]="selectedIndex$ | async"
    (selectedIndexChange)="updateQueryParams($event)"
>
    @for (tab of tabs; track tab) {
        <mat-tab [label]="tab">
            <div class="mt-4 pb-4">
                @switch (tab) {
                    @case ('Profile') {
                        <ng-container [ngTemplateOutlet]="profileTemplate" />
                    }
                    @case ('Courses') {
                        <ng-container [ngTemplateOutlet]="coursesTemplate" />
                    }
                    @default {
                        <div class="data-not-found">Invalid</div>
                    }
                }
            </div>
        </mat-tab>
    }
</mat-tab-group>

<ng-template #profileTemplate>
    <div class="flex flex-col space-y-2">
        <div class="flex items-center space-x-2">
            <span class="text-lg font-bold">Legal Name:</span>
            <span>{{ student | studentName: StudentNameStyle.FIRST_MIDDLE_LAST }}</span>
        </div>
        <div class="mt-4 flex items-center space-x-2">
            <span class="text-lg font-bold">Email:</span>
            <span>{{ student.email }}</span>
        </div>

        <div class="flex space-x-4">
            <button mat-flat-button (click)="onUpdateStudent(student)">Edit</button>
            <button mat-button (click)="onDeleteStudent(student)">Delete</button>
        </div>
    </div>
</ng-template>

<ng-template #coursesTemplate>
    <div class="flex flex-col space-y-4 sm:flex-row sm:space-x-2">
        <div class="flex justify-center sm:justify-start">
            <button mat-button type="button" (click)="onRegisterForCourse(student)">Register for a new course</button>
        </div>
        <div class="flex flex-wrap gap-4 p-2">
            @for (registration of student.registrations; track registration.id) {
                <app-students-registered-course
                    [registration]="registration"
                    (unregisterStudent)="OnUnregisterFromCourse($event)"
                />
            } @empty {
                <div class="data-not-found">No courses registered</div>
            }
        </div>
    </div>
</ng-template>
